<%-include('../head')-%>

    <%-include('../navbar')-%>

        <%-include('../sidebar')-%>

            <body class="bg-light">
                <div class="container">

                    <section>
                        <div class="row">
                            <div class="mt-3 col-lg-6 col-12 mb-3 p-3 p-lg-0"><img src="<%=locals.currentBanner.image.path%>" alt="" id="croppedImg"
                                    style="width: fit-content;"></div>
                        </div>
                        <div class="col-12 col-lg-6 p-3">
                            <form action="/admin/editBanner?bannerId=<%=locals.currentBanner._id%>" method="post" class="row d-flex"
                                enctype="multipart/form-data" id="bannerForm">
                                <div class="card p-md-5 p-2 mt-2 lh-lg">
                                    <h5>Choose Banner Image</h5>
                                    <span class="fw-normal mb-4 text-success">*file supports only:
                                        jpeg,jpg,png,webp</span>
                                    <span class="fw-bold">Select the Banner Image</span>

                                    <input type="file" accept=".jpg,.jpeg,.png,.webp" class="form-control FilUploader"
                                        name="bannerImg" class="mb-3" style="margin-top: 5px;" id="bannerImg"
                                        />


                                    <input type="hidden" id="imageName" name="imageName" value="">

                                    <div class="d-flex mb-5 mt-3">
                                        <div class="form-group col-md-6 mt-3">
                                            <label for="startDate" class="fw-bold mb-2">Start Date</label>
                                            <input type="date" oninput="setStartDate()" name="startDate" id="startDate" class="form-control"
                                                value="<%=locals.currentBanner.startDate.toISOString().split('T')[0]%>" required>
                                        </div>

                                        <div class="form-group col-md-6 mt-3">
                                            <label for="endDate" class="fw-bold mb-2">End Date</label>
                                            <input type="date" name="endDate" id="endDate" class="form-control"
                                            value="<%=locals.currentBanner.endDate.toISOString().split('T')[0]%>" required>
                                        </div>
                                    </div>

                                </div>



                                <div class=" p-4 mt-4 border bg-white">
                                    <div class="form-group mb-4">
                                        <label for="bannerTitle" class="fw-bold mb-2">Banner Title</label>
                                        <input type="text" name="bannerTitle" id="bannerTitle" class="form-control"
                                           value="<%=locals.currentBanner.title%>" required>
                                    </div>
                                    <div class="row mb-4">
                                        <div class="form-group mb-4">
                                            <label for="bannerUrl" class="fw-bold mb-2">Banner Image Url</label>
                                            <input type="text" name="bannerUrl" id="bannerUrl" class="form-control"
                                               value="<%=locals.currentBanner.bannerUrl%>" readonly>
                                        </div>
                                    </div>

                                    <div class="mt-4">
                                        <button type="submit" class="btn btn-primary btn-lg w-100">Update</button>
                                    </div>
                                </div>
                            </form>
                        </div>

                    </section>



                    <div class="modal fade " id="modal" tabindex="-1" role="dialog" aria-labelledby="modalLabel"
                        aria-hidden="true">
                        <div class="modal-dialog modal-lg" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="modalLabel">Crop image</h5>
                                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">Ã—</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <div class="img-container">
                                        <div class="row">
                                            <div class="col-md-8">
                                                <!--  default image where we will set the src via jquery-->
                                                <img id="image" style="display: block; max-width: 100%;">
                                            </div>
                                            <div class="col-md-4">
                                                <div class="preview"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary"
                                        data-bs-dismiss="modal">Cancel</button>
                                    <button type="button" class="btn btn-primary" id="crop">Crop</button>
                                </div>
                            </div>
                        </div>
                    </div>



                </div>



                <script>
                    let startDate = document.getElementById('startDate')
                    let currentDate = new Date().toISOString().split('T')[0]
                    startDate.min = currentDate

                    let endDate = document.getElementById('endDate')
                    function setStartDate(){////set start date of end date input
                        endDate.min = startDate.value
                    }
                </script>

                <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
                    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
                    crossorigin="anonymous"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
                    integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
                    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
                <script src="/home/ubuntu/Shopvista/node_modules/cropperjs/dist/cropper.min.js"
                    type="module"></script>
                <script src="/admin/script/croppBanner.js"></script>
            </body>

            </html>
